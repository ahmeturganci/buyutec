
@{
    ViewBag.Title = "ProjeSurecDetay";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="box box-primary">
    <div class="box-header">
        <i class="ion ion-clipboard"></i>
        <h3 class="box-title">Süreçler Listesi</h3>
        <div class="box-body">
            <div class="box-body table-responsive no-padding">
                <table class="table table-hover">
                    <tr>
                        <th>Süreçler</th>
                        <th>Başlama Tarihi</th>
                        <th>Bitiş Tarihi</th>
                        <th>Atanan Kişiler</th>
                        <th>Açıklama</th>
                        <th>Durum</th>
                        <th>Öncelik</th>
                        <th>Bitirme Oranı</th>
                        <th></th>
                    </tr>
                    <tbody id="pDetay"></tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<div class="box-body">
    <button id="Yazdır" class="btn btn-primary pull-right" onclick=" window.print();" ><i class="fa fa-print"></i> Yazdır</button>
</div>

<script>
    $(function () {
        $("body").load(SurecCek());
    });
    function AltSurecCek(surecId) {
        var data = {
            surecId: surecId
        };
        //console.log("alt surec");
        $.post("/Proje/AltSurecListele", data, function (sonuc) {
            $.each(sonuc, function (i, item) {
                //alert(item.altSurecId);
                var sId = item.altSurecId;
                $("#tr" + surecId).after('<tr style="background-color: #222d32;color: white;"><td><i class="fa fa-arrow-right"></i>' + item.altSurecAdi + '</td> <td>' + item.baslangicTarihi + '</td> <td>' + item.bitisTarihi + '</td> <td id="altSurectekiKullanicilar"></td> <td>' + item.aciklama + '</td> <td><span class="label label-danger">' + item.durumId + '</span></td> <td>' + item.oncelikId + '</td> <td> <div class="progress progress-md progress-striped active"> <div class="progress-bar progress-bar-success" style="width:90%">' + item.bitirmeOrani + '</div> </div> </td> <td><span class="badge bg-green">' + item.bitirmeOrani + '%</span></td> </tr>')
            });
        });
    }
    function SurecCek() {
        $.post("/Proje/SurecListele", function (sonuc) {
            $.each(sonuc, function (i, item) {
                console.log(item);
                var sId = item.surecId;
                $("#pDetay").append('<tr id="tr'+item.surecId+'"><td>' + item.surecAdi + '</td><td>' + item.baslangicTarihi + '</td><td>' + item.bitisTarihi + '</td><td id="surectekiKullanicilar"></td><td>' + item.aciklama + '</td><td><span class="label label-danger">' + item.durumId + '</span></td><td>' + item.oncelikId + '</td><td><div class="progress progress-md progress-striped active"><div class="progress-bar progress-bar-success" style="width:90%">' + item.bitirmeOrani + '</div></div></td><td><span class="badge bg-green">' + item.bitirmeOrani + '%</span></td></tr><br>');
                
                AltSurecCek(sId);
                


            });
        });
    }

   
</script>
